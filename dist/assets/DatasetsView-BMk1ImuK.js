import{p as re,J as F,n as Re,a7 as Le,q as $e,a8 as ue,a9 as ee,r as b,s as je,H as Ne,O as Ee,v as Me,A as Ue,a as l,y as j,b as i,F as T,C as ce,a2 as Oe,aa as We,e as Ge,f as qe,l as z,w as u,d as h,t as D,k as C,c as I,m as q,j as H,a5 as te,o as g,B as He}from"./index-CIFTxPdQ.js";import{a as Je,V as Ke,b as Qe}from"./VList-ChwA_U5y.js";import{V as Xe,d as A,b as ae,c as le,v as Ye,s as Ze,a as ne}from"./VContainer-DLDiluWH.js";import{a as P,V as J}from"./VRow-Cn8DOXCz.js";import{V as B}from"./VChip-D0hwUr_Y.js";import{u as et,V as se,a as ie,f as tt,b as at,m as lt,c as nt}from"./VInput-CLdxhY6f.js";import{V as st}from"./VAlert-Dkfmlq2u.js";import{V as it}from"./VSnackbar-Bnu5xXep.js";import{V as ot}from"./VMenu-4i-CeKoa.js";import{V as oe}from"./VDivider-mB0BFwfR.js";import{_ as rt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VOverlay-D7FNAPds.js";function ut(){function e(c){return[...c.dataTransfer?.items??[]].filter(o=>o.kind==="file").map(o=>o.webkitGetAsEntry()).filter(Boolean).length>0||[...c.dataTransfer?.files??[]].length>0}async function n(c){const f=[],o=[...c.dataTransfer?.items??[]].filter(s=>s.kind==="file").map(s=>s.webkitGetAsEntry()).filter(Boolean);if(o.length)for(const s of o){const y=await de(s,fe(".",s));f.push(...y.map(d=>d.file))}else f.push(...c.dataTransfer?.files??[]);return f}return{handleDrop:n,hasFilesOrFolders:e}}function de(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Promise((c,f)=>{e.isFile?e.file(s=>c([{file:s,path:n}]),f):e.isDirectory&&e.createReader().readEntries(async s=>{const y=[];for(const d of s)y.push(...await de(d,fe(n,d)));c(y)})})}function fe(e,n){return n.isDirectory?`${e}/${n.name}`:e}const ct=re({filterByType:String},"file-accept");function dt(e){const n=F(()=>e.filterByType?ft(e.filterByType):null);function c(f){if(n.value){const o=f.filter(n.value);return{accepted:o,rejected:f.filter(s=>!o.includes(s))}}return{accepted:f,rejected:[]}}return{filterAccepted:c}}function ft(e){const n=e.split(",").map(s=>s.trim().toLowerCase()),c=n.filter(s=>s.startsWith(".")),f=n.filter(s=>s.endsWith("/*")),o=n.filter(s=>!c.includes(s)&&!f.includes(s));return s=>{const y=s.name.split(".").at(-1)?.toLowerCase()??"",d=s.type.split("/").at(0)?.toLowerCase()??"";return o.includes(s.type)||c.includes(`.${y}`)||f.includes(`${d}/*`)}}const pt=re({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...lt({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>ue(e).every(n=>n!=null&&typeof n=="object")},...ct(),...at({clearable:!0})},"VFileInput"),mt=Re()({name:"VFileInput",inheritAttrs:!1,props:pt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,n){let{attrs:c,emit:f,slots:o}=n;const{t:s}=Le(),{filterAccepted:y}=dt(e),d=$e(e,"modelValue",e.modelValue,a=>ue(a),a=>!e.multiple&&Array.isArray(a)?a[0]:a),{isFocused:S,focus:N,blur:E}=et(e),R=F(()=>typeof e.showSize!="boolean"?e.showSize:void 0),_=F(()=>(d.value??[]).reduce((a,m)=>{let{size:w=0}=m;return a+w},0)),L=F(()=>ee(_.value,R.value)),p=F(()=>(d.value??[]).map(a=>{const{name:m="",size:w=0}=a,k=be(m);return e.showSize?`${k} (${ee(w,R.value)})`:k})),t=F(()=>{const a=d.value?.length??0;return e.showSize?s(e.counterSizeString,a,L.value):s(e.counterString,a)}),r=b(),x=b(),v=b(),M=je(()=>S.value||e.active),K=F(()=>["plain","underlined"].includes(e.variant)),$=Ne(!1),{handleDrop:pe,hasFilesOrFolders:me}=ut();function U(){v.value!==document.activeElement&&v.value?.focus(),S.value||N()}function ve(a){v.value?.click()}function ye(a){f("mousedown:control",a)}function ge(a){v.value?.click(),f("click:control",a)}function he(a){a.stopPropagation(),U(),Oe(()=>{d.value=[],We(e["onClick:clear"],a)})}function be(a){if(a.length<Number(e.truncateLength))return a;const m=Math.floor((Number(e.truncateLength)-1)/2);return`${a.slice(0,m)}â€¦${a.slice(a.length-m)}`}function xe(a){a.preventDefault(),a.stopImmediatePropagation(),$.value=!0}function we(a){a.preventDefault(),$.value=!1}async function ke(a){if(a.preventDefault(),a.stopImmediatePropagation(),$.value=!1,!v.value||!me(a))return;const m=await pe(a);Q(m)}function Ve(a){if(!(!a.target||a.repack))if(e.filterByType)Q([...a.target.files]);else{const m=a.target;d.value=[...m.files??[]]}}function Q(a){const m=new DataTransfer,{accepted:w,rejected:k}=y(a);k.length&&f("rejected",k);for(const W of w)m.items.add(W);v.value.files=m.files,d.value=[...m.files];const O=new Event("change",{bubbles:!0});O.repack=!0,v.value.dispatchEvent(O)}return Ee(d,a=>{(!Array.isArray(a)||!a.length)&&v.value&&(v.value.value="")}),Me(()=>{const a=!!(o.counter||e.counter),m=!!(a||o.details),[w,k]=Ue(c),{modelValue:O,...W}=se.filterProps(e),De={...ie.filterProps(e),"onClick:clear":he},Ce=c.webkitdirectory!==void 0&&c.webkitdirectory!==!1,Fe=c.accept?String(c.accept):void 0,Se=Ce?void 0:e.filterByType??Fe;return l(se,j({ref:r,modelValue:e.multiple?d.value:d.value[0],class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--dragging":$.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":K.value},e.class],style:e.style,"onClick:prepend":ve},w,W,{centerAffix:!K.value,focused:S.value}),{...o,default:G=>{let{id:Ie,isDisabled:X,isDirty:Y,isReadonly:Z,isValid:Ae,hasDetails:Be}=G;return l(ie,j({ref:x,prependIcon:e.prependIcon,onMousedown:ye,onClick:ge,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},De,{id:Ie.value,active:M.value||Y.value,dirty:Y.value||e.dirty,disabled:X.value,focused:S.value,details:Be.value,error:Ae.value===!1,onDragover:xe,onDrop:ke}),{...o,default:_e=>{let{props:{class:ze,...Pe},controlRef:Te}=_e;return i(T,null,[i("input",j({ref:V=>v.value=Te.value=V,type:"file",accept:Se,readonly:Z.value,disabled:X.value,multiple:e.multiple,name:e.name,onClick:V=>{V.stopPropagation(),Z.value&&V.preventDefault(),U()},onChange:Ve,onDragleave:we,onFocus:U,onBlur:E},Pe,k),null),i("div",{class:ce(ze)},[!!d.value?.length&&!e.hideInput&&(o.selection?o.selection({fileNames:p.value,totalBytes:_.value,totalBytesReadable:L.value}):e.chips?p.value.map(V=>l(B,{key:V,size:"small",text:V},null)):p.value.join(", "))])])}})},details:m?G=>i(T,null,[o.details?.(G),a&&i(T,null,[i("span",null,null),l(nt,{active:!!d.value?.length,value:t.value,disabled:e.disabled},o.counter)])]):void 0})}),tt({},r,x,v)}}),vt={key:0},yt={key:0,class:"text-center mt-12"},gt={key:1,class:"text-center mt-12"},ht={class:"pa-4 d-flex justify-space-between align-start"},bt={class:"d-flex align-center"},xt={class:"text-subtitle-1 font-weight-bold text-truncate text-high-emphasis",style:{"max-width":"180px"}},wt={class:"text-caption text-medium-emphasis"},kt={class:"pa-4 flex-grow-1"},Vt={class:"d-flex justify-space-between mb-3"},Dt={class:"d-flex rounded-lg overflow-hidden mb-3",style:{height:"8px",background:"rgba(128,128,128,0.2)"}},Ct={class:"d-flex flex-wrap ga-2"},Ft={class:"pa-2"},St=Ge({__name:"DatasetsView",setup(e){const n=Je(),c=b([]),f=b(null),o=b(!1),s=b(!0),y=b(!1),d=["#00BFA5","#5E35B1","#FFC107","#E53935"],S=p=>d[p%d.length],N=()=>{f.value?.click()},E=async p=>{if(!p)return;const t=Array.isArray(p)?p:[p];t.length>0&&t[0]&&await _(t[0])},R=async p=>{o.value=!1;const t=p.dataTransfer?.files;if(t&&t.length>0){const r=t[0];r&&(r.type==="text/csv"||r.name.endsWith(".csv"))?await _(r):n.error="Only CSV files are allowed."}},_=async p=>{try{await n.uploadDataset(p),y.value=!0,c.value=[]}catch{}},L=async(p,t)=>{confirm("Are you sure you want to delete this dataset?")&&await n.deleteDataset(p,t)};return qe(async()=>{await n.fetchDatasets(),s.value=!1}),(p,t)=>(g(),z(Xe,{fluid:"",class:"pa-0"},{default:u(()=>[l(J,{class:"mb-4 align-center"},{default:u(()=>[l(P,{cols:"12",md:"8"},{default:u(()=>[...t[5]||(t[5]=[i("h1",{class:"text-h4 font-weight-bold text-high-emphasis"},"Dataset Lab",-1),i("p",{class:"text-subtitle-1 text-medium-emphasis"}," Upload your CSV files. We'll automatically analyze them for class imbalance. ",-1)])]),_:1}),l(P,{cols:"12",md:"4",class:"text-md-right"},{default:u(()=>[l(B,{color:"primary",variant:"flat",class:"font-weight-bold"},{default:u(()=>[l(A,{start:"",icon:"mdi-database"}),h(" "+D(C(n).datasets.length)+" Datasets ",1)]),_:1})]),_:1})]),_:1}),l(J,null,{default:u(()=>[l(P,{cols:"12",lg:"4"},{default:u(()=>[l(ae,{class:"glass-card pa-6",elevation:"0",style:{position:"sticky",top:"90px"}},{default:u(()=>[t[10]||(t[10]=i("div",{class:"text-h6 font-weight-bold mb-4 text-high-emphasis"},"Upload New Data",-1)),i("div",{class:ce(["upload-zone rounded-xl mb-4 d-flex flex-column align-center justify-center text-center pa-8",{"is-dragging":o.value}]),onDragover:t[1]||(t[1]=H(r=>o.value=!0,["prevent"])),onDragleave:t[2]||(t[2]=H(r=>o.value=!1,["prevent"])),onDrop:H(R,["prevent"]),onClick:N},[l(le,{color:"primary",variant:"tonal",size:"64",class:"mb-4"},{default:u(()=>[l(A,{icon:"mdi-cloud-upload",size:"32"})]),_:1}),t[7]||(t[7]=i("h3",{class:"text-h6 font-weight-bold text-high-emphasis"},"Drag CSV here",-1)),t[8]||(t[8]=i("p",{class:"text-caption text-medium-emphasis mb-4"},"or click to browse files",-1)),l(mt,{ref_key:"fileInput",ref:f,modelValue:c.value,"onUpdate:modelValue":[t[0]||(t[0]=r=>c.value=r),E],accept:".csv","hide-input":"","prepend-icon":"",class:"d-none"},null,8,["modelValue"]),l(B,{size:"small",color:"medium-emphasis",variant:"outlined"},{default:u(()=>[...t[6]||(t[6]=[h("Max 1GB (Basic)",-1)])]),_:1})],34),C(n).isLoading?(g(),I("div",vt,[t[9]||(t[9]=i("div",{class:"d-flex justify-space-between text-caption mb-1 text-high-emphasis"},[i("span",null,"Uploading & Analyzing..."),i("span",null,"100%")],-1)),l(Ye,{indeterminate:"",color:"secondary",rounded:"",height:"6"})])):q("",!0),C(n).error?(g(),z(st,{key:1,type:"error",variant:"tonal",closable:"",class:"mt-4 text-caption","onClick:close":t[3]||(t[3]=r=>C(n).error=null)},{default:u(()=>[h(D(C(n).error),1)]),_:1})):q("",!0)]),_:1})]),_:1}),l(P,{cols:"12",lg:"8"},{default:u(()=>[s.value?(g(),I("div",yt,[l(Ze,{indeterminate:"",color:"primary",size:"64"}),t[11]||(t[11]=i("div",{class:"mt-4 text-medium-emphasis"},"Loading your library...",-1))])):C(n).datasets.length===0?(g(),I("div",gt,[l(A,{icon:"mdi-database-off",size:"64",color:"grey",class:"mb-4"}),t[12]||(t[12]=i("h3",{class:"text-h6 text-high-emphasis"},"No datasets found",-1)),t[13]||(t[13]=i("p",{class:"text-body-2 text-medium-emphasis"},"Upload a CSV file to start your first experiment.",-1))])):(g(),z(J,{key:2},{default:u(()=>[(g(!0),I(T,null,te(C(n).datasets,r=>(g(),z(P,{key:r.id,cols:"12",md:"6"},{default:u(()=>[l(ae,{class:"glass-card h-100 d-flex flex-column",hover:"",border:""},{default:u(()=>[i("div",ht,[i("div",bt,[l(le,{color:"secondary",variant:"tonal",rounded:"",class:"me-3"},{default:u(()=>[l(A,{icon:"mdi-file-delimited"})]),_:1}),i("div",null,[i("div",xt,D(r.fileName),1),i("div",wt,D(new Date(r.createdAt?.seconds*1e3).toLocaleDateString()),1)])]),l(ot,null,{activator:u(({props:x})=>[l(ne,j({icon:"mdi-dots-vertical",variant:"text",size:"small"},{ref_for:!0},x),null,16)]),default:u(()=>[l(Ke,{density:"compact"},{default:u(()=>[l(Qe,{"prepend-icon":"mdi-delete",title:"Delete",color:"error",onClick:x=>L(r.id,r.storagePath)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),l(oe,{class:"border-opacity-25"}),i("div",kt,[i("div",Vt,[t[14]||(t[14]=i("span",{class:"text-caption text-medium-emphasis"},"Detected Type",-1)),l(B,{size:"small",color:r.type==="binary"?"info":"purple",label:"",class:"font-weight-bold text-uppercase"},{default:u(()=>[h(D(r.type),1)]),_:2},1032,["color"])]),t[15]||(t[15]=i("div",{class:"text-caption text-medium-emphasis mb-1"},"Class Distribution",-1)),i("div",Dt,[(g(!0),I(T,null,te(r.imbalanceRatios,(x,v,M)=>(g(),I("div",{key:v,style:He({width:x*100+"%",backgroundColor:S(M)})},null,4))),128))]),i("div",Ct,[l(B,{size:"x-small",variant:"outlined",class:"text-medium-emphasis"},{default:u(()=>[h(" Target: "+D(Object.keys(r.imbalanceRatios)[0]),1)]),_:2},1024),r.anomalies?.length?(g(),z(B,{key:0,size:"x-small",variant:"outlined",color:"warning"},{default:u(()=>[h(D(r.anomalies.length)+" Issues Found ",1)]),_:2},1024)):q("",!0)])]),l(oe,{class:"border-opacity-25"}),i("div",Ft,[l(ne,{block:"",variant:"text",color:"primary",to:"/app/workflows"},{default:u(()=>[t[16]||(t[16]=h(" Use in Workflow ",-1)),l(A,{end:"",icon:"mdi-arrow-right"})]),_:1})])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}),l(it,{modelValue:y.value,"onUpdate:modelValue":t[4]||(t[4]=r=>y.value=r),color:"success",location:"bottom end"},{default:u(()=>[l(A,{start:"",icon:"mdi-check"}),t[17]||(t[17]=h(" Dataset uploaded successfully! ",-1))]),_:1},8,["modelValue"])]),_:1}))}}),Et=rt(St,[["__scopeId","data-v-deb2a2c7"]]);export{Et as default};
